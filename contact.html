<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Connect - Rithika's Website</title>
    <link rel="stylesheet" href="/style.css">
    <!-- Load EmailJS SDK as a regular script, not a module -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <!-- Initialize EmailJS directly in the head -->
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize EmailJS
            emailjs.init("IQQqJBlmNLVOkWWax");
            console.log("EmailJS initialized in HTML");
        });
    </script>
</head>
<body>
    <div class="main-container">
        <div class="content-container">
            <div class="contact-container">
                <h1 class="contact-title">Talk to me, chief</h1>
                <p class="contact-subtitle">"I want to be with those who know secret things". -Rainer Maria Rilke </p>
                <p class="contact-subtitle">You can email me directly at rkrox24@gmail.com or fill out this handy form -</p>
                
                <form id="contact-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Name<span class="required">*</span></label>
                            <input type="text" id="name" name="from_name" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email<span class="required">*</span></label>
                            <input type="email" id="email" name="from_email" class="form-input" required>
                        </div>
                    </div>
                
                    <div class="form-group">
                        <label class="form-label">What's bringing you my way?</label>
                        <div class="dropdown-container">
                            <button type="button" class="dropdown-trigger">
                                <span class="dropdown-text"></span>
                                <svg class="dropdown-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <div class="dropdown-content hidden">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="collaborate">
                                    <span>Interest in collaborating on a project</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="advice">
                                    <span>Seeking advice</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="chat">
                                    <span>Casual chit chat</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="feedback">
                                    <span>Providing feedback</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="incident">
                                    <span>You know about the incident at the Home Depot parking lot...</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="reason" value="other">
                                    <span>Other mysterious reason not listed here</span>
                                </label>
                            </div>
                        </div>
                    </div>
                
                    <div class="form-group">
                        <label class="form-label">Message<span class="required">*</span></label>
                        <textarea id="message" name="message" class="form-textarea" required></textarea>
                    </div>
                
                    <div class="form-actions">
                        <div class="social-links">
                            <a href="https://x.com/rithika24k" class="social-icon" target="_blank" rel="noopener noreferrer">
                                <img src="/x.jpg" alt="X">
                            </a>
                            <a href="https://www.linkedin.com/in/rithikakorrapolu/" class="social-icon" target="_blank" rel="noopener noreferrer">
                                <img src="/linkedin.jpg" alt="LinkedIn">
                            </a>
                            <a href="https://rithikakorrapolu.substack.com/?utm_source=substack&utm_medium=web&utm_campaign=substack_profile" class="social-icon" target="_blank" rel="noopener noreferrer">
                                <img src="/substack.jpg" alt="Substack">
                            </a>
                            <a href="https://www.youtube.com/@TheBigSuitShow" class="social-icon" target="_blank" rel="noopener noreferrer">
                                <img src="/youtube.jpg" alt="YouTube">
                            </a>
                        </div>
                        <div class="form-footer">
                            <p class="tagline">We are the future. Believe.</p>
                            <button type="submit" class="send-button">Send</button>
                        </div>
                    </div>
                    <input type="hidden" id="selected-reasons" name="reasons">
                </form>
            </div>
        </div>

        <nav class="navbar">
            <div class="nav-content">
                <div class="site-title">
                    <a href="index.html">Rithika's website</a>
                    <span class="separator">|</span>
                    <span class="current-page">connect</span>
                </div>
                
                <button class="menu-trigger">
                    <span>menu</span>
                </button>
            </div>
        
            <div class="menu-popup hidden">
                <a href="about.html">about</a>
                <a href="likes.html">likes</a>
                <a href="portfolio.html">portfolio</a>
                <a href="contact.html">connect</a>
            </div>
        </nav>
    </div>

    <!-- Add direct form handling script that doesn't rely on main.js -->
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize form components
            initializeContactForm();
        });

        function initializeContactForm() {
            console.log('Directly initializing contact form in HTML');
            
            // Initialize dropdown
            const dropdownTrigger = document.querySelector('.dropdown-trigger');
            const dropdownContent = document.querySelector('.dropdown-content');
            
            if (dropdownTrigger && dropdownContent) {
                // Initialize dropdown state
                dropdownTrigger.setAttribute('aria-expanded', 'false');
                
                // Add click handler to dropdown trigger
                dropdownTrigger.addEventListener('click', function(event) {
                    event.preventDefault();
                    const trigger = event.currentTarget;
                    const content = trigger.nextElementSibling;
                    const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
                    
                    trigger.setAttribute('aria-expanded', !isExpanded);
                    content.classList.toggle('hidden');
                    
                    if (!isExpanded) {
                        const closeDropdown = function(e) {
                            if (!trigger.contains(e.target) && !content.contains(e.target)) {
                                trigger.setAttribute('aria-expanded', 'false');
                                content.classList.add('hidden');
                                document.removeEventListener('click', closeDropdown);
                            }
                        };
                        document.addEventListener('click', closeDropdown);
                    }
                });
                
                // Add checkbox listeners
                const checkboxes = document.querySelectorAll('.checkbox-label input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', updateSelectionCount);
                });
            }

            function updateSelectionCount() {
                const checkboxes = document.querySelectorAll('.checkbox-label input[type="checkbox"]:checked');
                const dropdownText = document.querySelector('.dropdown-text');
                const selectedReasonsInput = document.getElementById('selected-reasons');
                
                if (checkboxes.length === 0) {
                    dropdownText.textContent = '';
                    selectedReasonsInput.value = '';
                } else {
                    dropdownText.textContent = `${checkboxes.length} selected`;
                    selectedReasonsInput.value = Array.from(checkboxes)
                        .map(cb => cb.nextElementSibling.textContent.trim())
                        .join(', ');
                }
            }

            // Initialize form submission
            const form = document.getElementById('contact-form');
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    console.log('Form submitted directly from HTML handler');
                    
                    // Get form data
                    const name = document.getElementById('name').value;
                    const email = document.getElementById('email').value;
                    const message = document.getElementById('message').value;
                    const reasons = document.getElementById('selected-reasons').value;

                    // Show loading state
                    const sendButton = form.querySelector('.send-button');
                    const originalButtonText = sendButton.textContent;
                    sendButton.textContent = 'Sending...';
                    sendButton.disabled = true;
                    
                    console.log('Preparing to send email with data:', { name, email, message, reasons });

                    // Create the template parameters
                    const templateParams = {
                        from_name: name,
                        from_email: email,
                        message: message,
                        reasons: reasons || 'None specified'
                    };
                    
                    // Send the email
                    emailjs.send('service_b566mfj', 'template_ea9zmeh', templateParams)
                        .then(function(response) {
                            console.log('SUCCESS!', response.status, response.text);
                            handleSuccess();
                        }, function(error) {
                            console.log('FAILED...', error);
                            handleError(error);
                        });

                    function handleSuccess() {
                        console.log('Email sent successfully');
                        // Success animation
                        sendButton.textContent = 'Sent!';
                        sendButton.classList.add('success');
                        
                        // Create fireworks
                        for (let i = 0; i < 5; i++) {
                            setTimeout(() => {
                                const firework = document.createElement('div');
                                firework.className = 'firework';
                                
                                // Random position around the button
                                const buttonRect = sendButton.getBoundingClientRect();
                                const randomX = buttonRect.x + Math.random() * buttonRect.width;
                                const randomY = buttonRect.y + Math.random() * buttonRect.height;
                                
                                firework.style.left = randomX + 'px';
                                firework.style.top = randomY + 'px';
                                
                                document.body.appendChild(firework);
                                
                                // Remove firework element after animation
                                setTimeout(() => {
                                    firework.remove();
                                }, 1000);
                            }, i * 100);
                        }
                        
                        // Reset form and button after delay
                        setTimeout(() => {
                            form.reset();
                            updateSelectionCount();
                            sendButton.textContent = originalButtonText;
                            sendButton.classList.remove('success');
                            sendButton.disabled = false;
                        }, 2000);
                    }

                    function handleError(error) {
                        console.error('Failed to send message:', error);
                        alert('Failed to send message. Details: ' + (error.text || error.message || 'Unknown error'));
                        
                        // Reset button
                        sendButton.textContent = originalButtonText;
                        sendButton.disabled = false;
                    }
                });
            } else {
                console.error('Contact form not found');
            }
        }
    </script>

    <!-- Load your main.js last -->
    <script type="module" src="/main.js"></script>
</body>
</html>