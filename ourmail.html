<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Mail - Shared Inbox</title>
    <link rel="stylesheet" href="/ourmail.css">
</head>
<body>
    <div class="mail-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo" id="logoBtn">
                <svg width="40" height="40" viewBox="0 0 48 48" fill="none">
                    <!-- Mailbox post -->
                    <rect x="20" y="28" width="8" height="14" fill="#E8D4A0"/>
                    <!-- Mailbox body base -->
                    <rect x="8" y="16" width="32" height="14" rx="3" fill="#5B9FD8"/>
                    <!-- Mailbox door -->
                    <path d="M 14 16 Q 14 26 14 30 L 20 30 Q 20 20 20 16 Z" fill="#2C4F8C"/>
                    <!-- Mailbox flag pole -->
                    <rect x="28" y="10" width="2" height="8" fill="#E74C3C"/>
                    <!-- Mailbox flag -->
                    <rect x="30" y="10" width="6" height="4" fill="#E74C3C"/>
                    <!-- Flag circle -->
                    <circle cx="29" cy="16" r="2" fill="#C0392B"/>
                </svg>
                <span class="logo-text">Our Mail</span>
            </div>

            <button class="compose-btn" id="composeBtn">
                Compose
            </button>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" id="inboxTab">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                    Inbox
                    <span class="count" id="emailCount">2</span>
                </a>
                <a href="#" class="nav-item" id="pinnedTab">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                    </svg>
                    Pinned
                </a>
                <a href="#" class="nav-item" id="feedbackTab">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                    E-Pen Pals
                </a>
            </nav>
        </div>

        <!-- Main content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-logo" id="headerLogoBtn">
                    <svg width="28" height="28" viewBox="0 0 48 48" fill="none">
                        <!-- Mailbox post -->
                        <rect x="20" y="28" width="8" height="14" fill="#E8D4A0"/>
                        <!-- Mailbox body base -->
                        <rect x="8" y="16" width="32" height="14" rx="3" fill="#5B9FD8"/>
                        <!-- Mailbox door -->
                        <path d="M 14 16 Q 14 26 14 30 L 20 30 Q 20 20 20 16 Z" fill="#2C4F8C"/>
                        <!-- Mailbox flag pole -->
                        <rect x="28" y="10" width="2" height="8" fill="#E74C3C"/>
                        <!-- Mailbox flag -->
                        <rect x="30" y="10" width="6" height="4" fill="#E74C3C"/>
                        <!-- Flag circle -->
                        <circle cx="29" cy="16" r="2" fill="#C0392B"/>
                    </svg>
                    <span class="header-logo-text">Our Mail</span>
                </div>
                <div class="search-bar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" placeholder="Search mail" id="searchInput">
                </div>
                <div class="menu-container">
                    <button class="icon-btn" id="menuBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"/>
                            <circle cx="19" cy="12" r="1"/>
                            <circle cx="5" cy="12" r="1"/>
                        </svg>
                    </button>
                    <div class="dropdown-menu hidden" id="dropdownMenu">
                        <button class="dropdown-item" id="contactUsBtn">Contact us</button>
                    </div>
                </div>
            </div>

            <!-- Selection toolbar (hidden by default) -->
            <div class="selection-toolbar hidden" id="selectionToolbar">
                <div class="toolbar-left">
                    <span class="selection-count" id="selectionCount">0 selected</span>
                </div>
                <div class="toolbar-actions">
                    <button class="icon-btn" id="downloadBtn" title="Download selected emails">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Email list -->
            <div class="email-list" id="emailList">
                <!-- Emails will be populated here -->
            </div>

            <!-- Email detail view (hidden by default) -->
            <div class="email-detail hidden" id="emailDetail">
                <div class="detail-header">
                    <button class="icon-btn" id="backBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 class="detail-subject"></h2>
                </div>
                <div class="detail-content">
                    <div class="detail-meta">
                        <div class="sender-info">
                            <strong class="detail-sender"></strong>
                            <span class="detail-timestamp"></span>
                        </div>
                        <div class="detail-actions-right">
                            <button class="heart-btn" id="heartBtn" title="Heart this email">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                                </svg>
                                <span class="heart-count" id="heartCount">0</span>
                            </button>
                            <button class="icon-btn" id="replyToggleBtn" title="Reply">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 14L4 9l5-5"/>
                                    <path d="M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11"/>
                                </svg>
                            </button>
                            <button class="icon-btn" id="downloadDetailBtn" title="Download this email">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="detail-body"></div>

                    <!-- Replies section -->
                    <div class="replies-section" id="repliesSection">
                        <!-- Replies will be populated here -->
                    </div>

                    <!-- Reply form -->
                    <div class="reply-form-container">
                        <form id="replyForm" class="reply-form">
                            <div class="reply-compose-box">
                                <div id="replyMessage" class="reply-editor" contenteditable="true" data-placeholder="Reply..."></div>
                                <div class="reply-toolbar">
                                    <button type="submit" class="send-btn-reply" id="replyBtn">Send</button>
                                    <div class="formatting-toolbar formatting-toolbar-inline">
                                        <button type="button" class="format-btn" id="boldBtnReply" title="Bold">
                                            <strong>B</strong>
                                        </button>
                                        <button type="button" class="format-btn" id="italicBtnReply" title="Italic">
                                            <em>I</em>
                                        </button>
                                        <button type="button" class="format-btn" id="linkBtnReply" title="Insert link">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                            </svg>
                                        </button>
                                    </div>
                                    <input type="text" id="replyFromName" placeholder="Name (optional)" maxlength="50" class="reply-name-inline">
                                    <div class="send-status hidden" id="replyStatus"></div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Compose modal -->
    <div class="compose-modal hidden" id="composeModal">
        <div class="compose-window">
            <form id="composeForm">
                <div class="compose-header">
                    <button class="icon-btn" type="button" id="closeComposeBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </button>
                    <span>New Message</span>
                    <div class="compose-header-actions">
                        <button type="button" class="format-btn" id="boldBtn" title="Bold">
                            <strong>B</strong>
                        </button>
                        <button type="button" class="format-btn" id="italicBtn" title="Italic">
                            <em>I</em>
                        </button>
                        <button type="button" class="format-btn" id="linkBtn" title="Insert link">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                            </svg>
                        </button>
                        <button type="submit" class="icon-btn send-btn-header" id="sendBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="compose-field">
                    <input type="text" id="fromName" placeholder="Name" maxlength="50">
                </div>
                <div class="compose-field">
                    <input type="text" id="subject" placeholder="Subject" required maxlength="100">
                </div>
                <div class="compose-field">
                    <div id="message" class="compose-editor" contenteditable="true" data-placeholder="Write your message to share with the world..."></div>
                </div>
                <div class="send-status hidden" id="sendStatus"></div>
            </form>
        </div>
    </div>

    <!-- Link modal -->
    <div class="link-modal hidden" id="linkModal">
        <div class="link-modal-content">
            <div class="link-modal-input-container">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                </svg>
                <input type="text" id="linkUrlInput" placeholder="Type or paste a link" class="link-input">
            </div>
            <button type="button" class="link-apply-btn" id="linkApplyBtn">Apply</button>
        </div>
    </div>

    <!-- E-Pen Pals Sign Up modal -->
    <div class="compose-modal hidden" id="penPalModal">
        <div class="compose-window">
            <form id="penPalForm">
                <div class="compose-header">
                    <button class="icon-btn" type="button" id="closePenPalBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </button>
                    <span>Sign up for an e-Pen Pal</span>
                    <button type="submit" class="icon-btn send-btn-header" id="penPalSubmitBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                        </svg>
                    </button>
                </div>
                <div class="compose-field">
                    <input type="text" id="penPalName" placeholder="What's your name?" required maxlength="100">
                </div>
                <div class="compose-field">
                    <input type="email" id="penPalEmail" placeholder="What's your email?" required maxlength="100">
                </div>
                <div class="compose-field">
                    <div id="penPalBio" class="compose-editor" contenteditable="true" data-placeholder="Give us a quick bio about yourself! What are you into? What makes you laugh? What do you want to talk about? What would you want someone to email you about that would get you excited?" style="min-height: 150px;"></div>
                </div>
                <div class="send-status hidden" id="penPalStatus"></div>
            </form>
        </div>
    </div>

    <!-- Feedback modal -->
    <div class="compose-modal hidden" id="feedbackModal">
        <div class="compose-window">
            <form id="feedbackModalForm">
                <div class="compose-header">
                    <button class="icon-btn" type="button" id="closeFeedbackBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </button>
                    <span>Contact Us</span>
                    <button type="submit" class="icon-btn send-btn-header" id="feedbackModalSendBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                        </svg>
                    </button>
                </div>
                <div class="compose-field">
                    <input type="text" id="feedbackModalFromName" value="Rithika (rkrox24@gmail.com)" readonly>
                </div>
                <div class="compose-field">
                    <input type="text" id="feedbackModalSubject" placeholder="Contacting you from OurMail">
                </div>
                <div class="compose-field">
                    <div id="feedbackModalMessage" class="compose-editor" contenteditable="true" data-placeholder="Have you noticed any bugs or have feature requests? Let me know and I'll try to work on them! Thanks for being here in general!

Leave your name and email if you'd like me to respond, thank you!"></div>
                </div>
                <div class="compose-field">
                    <input type="text" id="feedbackModalUserName" placeholder="Your name (optional)" maxlength="50">
                </div>
                <div class="compose-field">
                    <input type="email" id="feedbackModalUserEmail" placeholder="Your email (optional)" maxlength="100">
                </div>
                <div class="send-status hidden" id="feedbackModalStatus"></div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="/ourmail.js"></script>
</body>
</html>
